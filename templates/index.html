{% extends "base.html" %}

{% block title %}Роскошная одежда класса люкс | {{ shop_name }}{% endblock %}

{% block extra_css %}
<style>
    /* Hero Section */
    .hero-section {
        position: relative;
        padding: 120px 0;
        background: linear-gradient(135deg, rgba(26, 26, 26, 0.9) 0%, rgba(42, 42, 42, 0.9) 100%);
        overflow: hidden;
        min-height: 100vh;
        display: flex;
        align-items: center;
    }
    
    .hero-bg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(42, 42, 42, 0.9) 100%);
        z-index: 0;
    }
    
    .hero-content {
        position: relative;
        z-index: 1;
        max-width: 800px;
        margin: 0 auto;
        text-align: center;
    }
    
    .hero-title {
        font-size: 5rem;
        font-weight: 900;
        margin-bottom: 20px;
        background: linear-gradient(135deg, var(--gold) 0%, var(--platinum) 50%, var(--rose-gold) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: shimmer 3s infinite;
    }
    
    .hero-subtitle {
        font-size: 1.5rem;
        color: var(--text-secondary);
        margin-bottom: 40px;
        line-height: 1.6;
        font-weight: 300;
        letter-spacing: 1px;
    }
    
    .hero-btns {
        display: flex;
        gap: 20px;
        justify-content: center;
        margin-top: 40px;
    }
    
    .btn-primary {
        padding: 18px 40px;
        background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
        color: var(--text-inverse);
        border-radius: var(--radius-xl);
        font-size: 1.1rem;
        font-weight: 600;
        letter-spacing: 1px;
        transition: all var(--transition-normal);
        display: inline-flex;
        align-items: center;
        gap: 12px;
        box-shadow: var(--shadow-gold);
        text-decoration: none;
        border: none;
        cursor: pointer;
    }
    
    .btn-primary:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px rgba(212, 175, 55, 0.4);
    }
    
    .btn-secondary {
        padding: 18px 40px;
        background: transparent;
        color: var(--gold);
        border: 2px solid var(--gold);
        border-radius: var(--radius-xl);
        font-size: 1.1rem;
        font-weight: 600;
        letter-spacing: 1px;
        transition: all var(--transition-normal);
        display: inline-flex;
        align-items: center;
        gap: 12px;
        text-decoration: none;
        cursor: pointer;
    }
    
    .btn-secondary:hover {
        background: rgba(212, 175, 55, 0.1);
        transform: translateY(-5px);
        box-shadow: var(--shadow-gold);
    }
    
    /* Collections Section */
    .collections-section {
        padding: 100px 0;
        background: var(--secondary-bg);
    }
    
    .section-header {
        text-align: center;
        margin-bottom: 60px;
    }
    
    .section-title {
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 15px;
        position: relative;
        display: inline-block;
    }
    
    .section-title::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 80px;
        height: 3px;
        background: linear-gradient(90deg, var(--gold) 0%, transparent 100%);
    }
    
    .section-subtitle {
        font-size: 1.1rem;
        color: var(--text-secondary);
        max-width: 600px;
        margin: 0 auto;
    }
    
    .collections-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 40px;
        margin-bottom: 60px;
    }
    
    .collection-card {
        background: var(--card-bg);
        border-radius: var(--radius-xl);
        overflow: hidden;
        transition: all var(--transition-normal);
        position: relative;
        height: 500px;
        box-shadow: var(--shadow-lg);
    }
    
    .collection-card:hover {
        transform: translateY(-15px);
        box-shadow: var(--shadow-xl);
    }
    
    .collection-image {
        width: 100%;
        height: 60%;
        position: relative;
        overflow: hidden;
    }
    
    .collection-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform var(--transition-slow);
    }
    
    .collection-card:hover .collection-image img {
        transform: scale(1.1);
    }
    
    .collection-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.7) 100%);
        display: flex;
        align-items: flex-end;
        padding: 30px;
    }
    
    .collection-content {
        padding: 30px;
        height: 40%;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }
    
    .collection-name {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 10px;
        color: var(--text-primary);
    }
    
    .collection-description {
        font-size: 0.9rem;
        color: var(--text-secondary);
        margin-bottom: 20px;
        line-height: 1.6;
    }
    
    .collection-stats {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
    }
    
    .stat-item {
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    
    .stat-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--gold);
    }
    
    .stat-label {
        font-size: 0.75rem;
        color: var(--text-tertiary);
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    .collection-link {
        display: flex;
        align-items: center;
        gap: 10px;
        color: var(--gold);
        font-weight: 600;
        font-size: 0.9rem;
        transition: all var(--transition-fast);
        text-decoration: none;
    }
    
    .collection-link:hover {
        gap: 15px;
    }
    
    /* Products Showcase */
    .products-section {
        padding: 100px 0;
    }
    
    .products-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
        margin-bottom: 40px;
    }
    
    .products-filter {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
    }
    
    .filter-btn {
        padding: 10px 24px;
        background: var(--surface-bg);
        border-radius: var(--radius-full);
        font-size: 0.9rem;
        font-weight: 500;
        transition: all var(--transition-fast);
        border: none;
        cursor: pointer;
        color: var(--text-primary);
    }
    
    .filter-btn:hover {
        background: var(--tertiary-bg);
        transform: translateY(-2px);
    }
    
    .filter-btn.active {
        background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
        color: var(--text-inverse);
        box-shadow: var(--shadow-gold);
    }
    
    .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 30px;
        margin-bottom: 60px;
    }
    
    .product-card {
        background: var(--card-bg);
        border-radius: var(--radius-xl);
        overflow: hidden;
        transition: all var(--transition-normal);
        box-shadow: var(--shadow-md);
        position: relative;
    }
    
    .product-card:hover {
        transform: translateY(-10px);
        box-shadow: var(--shadow-lg);
    }
    
    .product-badges {
        position: absolute;
        top: 15px;
        left: 15px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        z-index: 2;
    }
    
    .product-badge {
        padding: 6px 12px;
        border-radius: var(--radius-full);
        font-size: 0.7rem;
        font-weight: 600;
        letter-spacing: 0.5px;
        text-transform: uppercase;
    }
    
    .badge-new {
        background: #10b981;
        color: white;
    }
    
    .badge-sale {
        background: #ef4444;
        color: white;
    }
    
    .badge-exclusive {
        background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
        color: white;
    }
    
    .badge-vip {
        background: #8b5cf6;
        color: white;
    }
    
    .badge-bestseller {
        background: #f59e0b;
        color: white;
    }
    
    .product-image {
        width: 100%;
        height: 350px;
        position: relative;
        overflow: hidden;
        background: var(--tertiary-bg);
    }
    
    .product-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform var(--transition-slow);
    }
    
    .product-card:hover .product-image img {
        transform: scale(1.05);
    }
    
    .product-actions {
        position: absolute;
        top: 15px;
        right: 15px;
        display: flex;
        flex-direction: column;
        gap: 8px;
        opacity: 0;
        transform: translateX(20px);
        transition: all var(--transition-normal);
        z-index: 2;
    }
    
    .product-card:hover .product-actions {
        opacity: 1;
        transform: translateX(0);
    }
    
    .action-btn {
        width: 40px;
        height: 40px;
        background: var(--card-bg);
        border-radius: var(--radius-full);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        color: var(--text-primary);
        transition: all var(--transition-fast);
        box-shadow: var(--shadow-sm);
        border: none;
        cursor: pointer;
    }
    
    .action-btn:hover {
        background: var(--gold);
        color: var(--text-inverse);
        transform: scale(1.1);
    }
    
    .product-info {
        padding: 25px;
    }
    
    .product-category {
        font-size: 0.8rem;
        color: var(--gold);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 8px;
        font-weight: 600;
    }
    
    .product-title {
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 10px;
        color: var(--text-primary);
        line-height: 1.4;
        height: 3.6em;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
    }
    
    .product-description {
        font-size: 0.9rem;
        color: var(--text-secondary);
        margin-bottom: 15px;
        line-height: 1.6;
        height: 4.8em;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
    }
    
    .product-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid var(--border-color);
    }
    
    .product-price {
        display: flex;
        align-items: baseline;
        gap: 8px;
    }
    
    .current-price {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--gold);
    }
    
    .original-price {
        font-size: 1rem;
        color: var(--text-tertiary);
        text-decoration: line-through;
    }
    
    .product-rating {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .stars {
        color: var(--gold);
        font-size: 0.9rem;
    }
    
    .rating-count {
        font-size: 0.8rem;
        color: var(--text-tertiary);
    }
    
    .product-footer {
        display: flex;
        gap: 12px;
    }
    
    .btn-add-cart {
        flex: 1;
        padding: 12px 24px;
        background: var(--surface-bg);
        border-radius: var(--radius-lg);
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        transition: all var(--transition-fast);
        border: none;
        cursor: pointer;
    }
    
    .btn-add-cart:hover {
        background: var(--gold);
        color: var(--text-inverse);
    }
    
    .btn-view {
        width: 46px;
        height: 46px;
        background: var(--surface-bg);
        border-radius: var(--radius-lg);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-primary);
        transition: all var(--transition-fast);
        text-decoration: none;
    }
    
    .btn-view:hover {
        background: var(--tertiary-bg);
        transform: scale(1.05);
    }
    
    /* View All Button */
    .view-all-section {
        text-align: center;
    }
    
    .btn-view-all {
        display: inline-flex;
        align-items: center;
        gap: 12px;
        padding: 18px 40px;
        background: transparent;
        color: var(--gold);
        border: 2px solid var(--gold);
        border-radius: var(--radius-xl);
        font-size: 1.1rem;
        font-weight: 600;
        letter-spacing: 1px;
        transition: all var(--transition-normal);
        text-decoration: none;
    }
    
    .btn-view-all:hover {
        background: rgba(212, 175, 55, 0.1);
        gap: 20px;
        transform: translateY(-3px);
        box-shadow: var(--shadow-gold);
    }
    
    /* Features Section */
    .features-section {
        padding: 100px 0;
        background: var(--secondary-bg);
    }
    
    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 40px;
    }
    
    .feature-card {
        background: var(--card-bg);
        padding: 40px 30px;
        border-radius: var(--radius-xl);
        text-align: center;
        transition: all var(--transition-normal);
        position: relative;
        overflow: hidden;
        box-shadow: var(--shadow-md);
    }
    
    .feature-card:hover {
        transform: translateY(-10px);
        box-shadow: var(--shadow-lg);
    }
    
    .feature-icon {
        width: 80px;
        height: 80px;
        background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
        border-radius: var(--radius-full);
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 25px;
        font-size: 32px;
        color: var(--text-inverse);
        box-shadow: var(--shadow-gold);
    }
    
    .feature-title {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 15px;
        color: var(--text-primary);
    }
    
    .feature-description {
        font-size: 0.95rem;
        color: var(--text-secondary);
        line-height: 1.6;
    }
    
    /* CTA Section */
    .cta-section {
        padding: 120px 0;
        background: linear-gradient(135deg, rgba(26, 26, 26, 0.95) 0%, rgba(42, 42, 42, 0.95) 100%);
        position: relative;
        overflow: hidden;
    }
    
    .cta-bg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(42, 42, 42, 0.9) 100%);
        opacity: 0.15;
        z-index: 0;
    }
    
    .cta-content {
        position: relative;
        z-index: 1;
        text-align: center;
        max-width: 800px;
        margin: 0 auto;
    }
    
    .cta-title {
        font-size: 3.5rem;
        font-weight: 700;
        margin-bottom: 20px;
        background: linear-gradient(135deg, var(--gold) 0%, var(--platinum) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .cta-text {
        font-size: 1.2rem;
        color: var(--text-secondary);
        margin-bottom: 40px;
        line-height: 1.6;
    }
    
    /* Animations */
    @keyframes shimmer {
        0%, 100% {
            background-position: -200% center;
        }
        50% {
            background-position: 200% center;
        }
    }
    
    /* Swiper */
    .swiper-container {
        width: 100%;
        height: 600px;
        border-radius: var(--radius-xl);
        overflow: hidden;
        box-shadow: var(--shadow-xl);
        margin-bottom: 60px;
    }
    
    .swiper-slide {
        position: relative;
    }
    
    .swiper-slide img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .swiper-content {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        padding: 60px;
        background: linear-gradient(to top, rgba(0, 0, 0, 0.8) 0%, transparent 100%);
        color: white;
    }
    
    .swiper-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 15px;
    }
    
    .swiper-subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
        margin-bottom: 25px;
    }
    
    /* Stats */
    .stats-section {
        padding: 80px 0;
        background: var(--primary-bg);
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 40px;
    }
    
    .stat-card {
        text-align: center;
        padding: 40px 20px;
        background: var(--card-bg);
        border-radius: var(--radius-xl);
        transition: all var(--transition-normal);
        box-shadow: var(--shadow-md);
    }
    
    .stat-card:hover {
        transform: translateY(-10px);
        box-shadow: var(--shadow-lg);
    }
    
    .stat-number {
        font-size: 3.5rem;
        font-weight: 900;
        background: linear-gradient(135deg, var(--gold) 0%, var(--platinum) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 15px;
    }
    
    .stat-text {
        font-size: 1.1rem;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    /* Price badge for rubles */
    .price-rub {
        position: relative;
    }
    
    .price-rub::after {
        content: '₽';
        font-size: 0.8em;
        margin-left: 2px;
    }
    
    /* Cart notification styles */
    .cart-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 10000;
        padding: 15px 20px;
        border-radius: 8px;
        color: white;
        display: none;
        align-items: center;
        gap: 12px;
        max-width: 350px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        animation: slideInRight 0.3s ease;
    }
    
    .cart-notification.show {
        display: flex;
    }
    
    .cart-notification-success {
        background: #10b981;
    }
    
    .cart-notification-error {
        background: #ef4444;
    }
    
    .cart-notification-warning {
        background: #f59e0b;
    }
    
    .cart-notification-info {
        background: #d4af37;
    }
    
    @keyframes slideInRight {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    
    /* Mobile Responsive */
    @media (max-width: 992px) {
        .hero-title {
            font-size: 3.5rem;
        }
        
        .collections-grid {
            grid-template-columns: 1fr;
        }
        
        .products-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 20px;
        }
        
        .products-grid {
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        }
    }
    
    @media (max-width: 768px) {
        .hero-title {
            font-size: 2.8rem;
        }
        
        .hero-subtitle {
            font-size: 1.2rem;
        }
        
        .section-title {
            font-size: 2.2rem;
        }
        
        .cta-title {
            font-size: 2.5rem;
        }
        
        .swiper-container {
            height: 400px;
        }
        
        .swiper-content {
            padding: 30px;
        }
        
        .swiper-title {
            font-size: 1.8rem;
        }
        
        .hero-btns {
            flex-direction: column;
            gap: 15px;
        }
        
        .btn-primary, .btn-secondary {
            width: 100%;
            justify-content: center;
        }
    }
    
    @media (max-width: 576px) {
        .hero-title {
            font-size: 2.2rem;
        }
        
        .section-title {
            font-size: 1.8rem;
        }
        
        .products-filter {
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .features-grid {
            grid-template-columns: 1fr;
        }
        
        .stat-card {
            padding: 30px 15px;
        }
        
        .stat-number {
            font-size: 2.5rem;
        }
    }
    
    /* Fix for button alignment */
    .btn-primary i, .btn-secondary i, .btn-view-all i {
        display: inline-block;
        vertical-align: middle;
    }
    
    /* Fix for flexbox issues */
    .hero-btns {
        flex-wrap: wrap;
    }
    
    /* Fix for product grid on small screens */
    @media (max-width: 480px) {
        .products-grid {
            grid-template-columns: 1fr;
        }
        
        .collection-card {
            height: 450px;
        }
    }
    
    /* Fix for image loading errors */
    img {
        object-fit: cover;
    }
    
    /* Fallback for broken images */
    img:before {
        content: " ";
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--tertiary-bg);
        color: var(--text-secondary);
        font-size: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
</style>
{% endblock %}

{% block content %}
    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-bg"></div>
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">{{ shop_name }}</h1>
                <p class="hero-subtitle">Эксклюзивные коллекции от ведущих мировых дизайнеров. <br>Одежда, которая подчеркивает ваш уникальный стиль и статус.</p>
                <div class="hero-btns">
                    <a href="{{ url_for('catalog_page') }}" class="btn-primary">
                        <i class="fas fa-shopping-bag"></i>
                        <span>В КАТАЛОГ</span>
                    </a>
                    <a href="#collections" class="btn-secondary">
                        <i class="fas fa-gem"></i>
                        <span>КОЛЛЕКЦИИ</span>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Collections -->
    <section id="collections" class="collections-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">ЭКСКЛЮЗИВНЫЕ КОЛЛЕКЦИИ</h2>
                <p class="section-subtitle">Откройте для себя уникальные подборки, созданные специально для ценителей высокой моды</p>
            </div>
            
            <div class="collections-grid">
                <!-- Коллекция 1 -->
                <div class="collection-card">
                    <div class="collection-image">
                        <div class="collection-overlay">
                            <div>
                                <h3 class="collection-name">Вечерняя коллекция</h3>
                                <div class="collection-stats">
                                    <div class="stat-item">
                                        <span class="stat-value">45</span>
                                        <span class="stat-label">Моделей</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-value">500k+</span>
                                        <span class="stat-label">Средний чек</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="collection-content">
                        <div>
                            <h3 class="collection-name">Вечерняя коллекция</h3>
                            <p class="collection-description">Роскошные платья и костюмы для особых случаев. Изысканные материалы ручной работы.</p>
                        </div>
                        <a href="{{ url_for('catalog_page') }}?category=Платья" class="collection-link">
                            <span>Смотреть коллекцию</span>
                            <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                
                <!-- Коллекция 2 -->
                <div class="collection-card">
                    <div class="collection-image">
                        <div class="collection-overlay">
                            <div>
                                <h3 class="collection-name">Деловая коллекция</h3>
                                <div class="collection-stats">
                                    <div class="stat-item">
                                        <span class="stat-value">68</span>
                                        <span class="stat-label">Моделей</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-value">300k+</span>
                                        <span class="stat-label">Средний чек</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="collection-content">
                        <div>
                            <h3 class="collection-name">Деловая коллекция</h3>
                            <p class="collection-description">Изысканные костюмы и аксессуары для успешных людей. Элегантность и статус.</p>
                        </div>
                        <a href="{{ url_for('catalog_page') }}?category=Костюмы" class="collection-link">
                            <span>Смотреть коллекцию</span>
                            <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                
                <!-- Коллекция 3 -->
                <div class="collection-card">
                    <div class="collection-image">
                        <div class="collection-overlay">
                            <div>
                                <h3 class="collection-name">Премиум аксессуары</h3>
                                <div class="collection-stats">
                                    <div class="stat-item">
                                        <span class="stat-value">120</span>
                                        <span class="stat-label">Позиций</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-value">200k+</span>
                                        <span class="stat-label">Средний чек</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="collection-content">
                        <div>
                            <h3 class="collection-name">Премиум аксессуары</h3>
                            <p class="collection-description">Эксклюзивные сумки, украшения и аксессуары от ведущих мировых брендов.</p>
                        </div>
                        <a href="{{ url_for('catalog_page') }}?category=Сумки" class="collection-link">
                            <span>Смотреть коллекцию</span>
                            <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="view-all-section">
                <a href="{{ url_for('catalog_page') }}" class="btn-view-all">
                    <span>ВЕСЬ КАТАЛОГ</span>
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Products Showcase -->
    <section class="products-section">
        <div class="container">
            <div class="products-header">
                <div>
                    <h2 class="section-title">НОВИНКИ СЕЗОНА</h2>
                    <p class="section-subtitle">Самые ожидаемые модели этого сезона</p>
                </div>
                <div class="products-filter">
                    <button class="filter-btn active" data-filter="all">Все</button>
                    <button class="filter-btn" data-filter="new">Новинки</button>
                    <button class="filter-btn" data-filter="exclusive">Эксклюзив</button>
                    <button class="filter-btn" data-filter="bestseller">Бестселлеры</button>
                </div>
            </div>
            
            <div class="products-grid">
                <!-- Динамические товары из базы данных -->
                {% if new_products %}
                    {% for product in new_products[:8] %}
                    <div class="product-card" data-category="{{ 'new' if product.is_new else 'exclusive' if product.is_exclusive else 'bestseller' if product.is_hit else 'all' }}">
                        <div class="product-badges">
                            {% if product.is_new %}<span class="product-badge badge-new">Новинка</span>{% endif %}
                            {% if product.discount > 0 %}<span class="product-badge badge-sale">-{{ product.discount }}%</span>{% endif %}
                            {% if product.is_exclusive %}<span class="product-badge badge-exclusive">Эксклюзив</span>{% endif %}
                            {% if product.is_hit %}<span class="product-badge badge-bestseller">Бестселлер</span>{% endif %}
                        </div>
                        <div class="product-image">
                            <img src="{{ product.image_url or url_for('static', filename='img/placeholder.jpg') }}" alt="{{ product.name }}" onerror="this.src='{{ url_for('static', filename='img/placeholder.jpg') }}';">
                            <div class="product-actions">
                                <button class="action-btn" title="В избранное" onclick="toggleWishlist({{ product.id }}, this)">
                                    <i class="far fa-heart"></i>
                                </button>
                                <button class="action-btn" title="Быстрый просмотр" onclick="quickView({{ product.id }})">
                                    <i class="far fa-eye"></i>
                                </button>
                                <button class="action-btn" title="Сравнить" onclick="addToCompare({{ product.id }}, this)">
                                    <i class="fas fa-exchange-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">{{ product.category }}</div>
                            <h3 class="product-title">{{ product.name }}</h3>
                            <p class="product-description">{{ product.description[:100] }}{% if product.description|length > 100 %}...{% endif %}</p>
                            <div class="product-meta">
                                <div class="product-price">
                                    <span class="current-price price-rub">{{ product.price|format_price }}</span>
                                    {% if product.old_price %}
                                    <span class="original-price price-rub">{{ product.old_price|format_price }}</span>
                                    {% endif %}
                                </div>
                                <div class="product-rating">
                                    <div class="stars">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star-half-alt"></i>
                                    </div>
                                    <span class="rating-count">({{ product.stock }})</span>
                                </div>
                            </div>
                            <div class="product-footer">
                                <button class="btn-add-cart" data-product-id="{{ product.id }}" data-price="{{ product.price }}" onclick="addToCart({{ product.id }}, this)">
                                    <i class="fas fa-shopping-bag"></i>
                                    <span>В корзину</span>
                                </button>
                                <a href="{{ url_for('product_detail', product_id=product.id) }}" class="btn-view" title="Подробнее">
                                    <i class="fas fa-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <!-- Статические товары (запасной вариант) -->
                    <!-- Продукт 1 -->
                    <div class="product-card" data-category="new exclusive">
                        <div class="product-badges">
                            <span class="product-badge badge-new">Новинка</span>
                            <span class="product-badge badge-exclusive">Эксклюзив</span>
                        </div>
                        <div class="product-image">
                            <img src="{{ url_for('static', filename='img/products/product-1.jpg') }}" alt="Платье Vogue Elite" onerror="this.src='{{ url_for('static', filename='img/placeholder.jpg') }}';">
                            <div class="product-actions">
                                <button class="action-btn" title="В избранное" onclick="toggleWishlist(1, this)">
                                    <i class="far fa-heart"></i>
                                </button>
                                <button class="action-btn" title="Быстрый просмотр" onclick="quickView(1)">
                                    <i class="far fa-eye"></i>
                                </button>
                                <button class="action-btn" title="Сравнить" onclick="addToCompare(1, this)">
                                    <i class="fas fa-exchange-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">Платья</div>
                            <h3 class="product-title">Шелковое вечернее платье с кружевом</h3>
                            <p class="product-description">Изысканное платье из натурального шелка с ручной вышивкой и французским кружевом.</p>
                            <div class="product-meta">
                                <div class="product-price">
                                    <span class="current-price price-rub">285,000</span>
                                    <span class="original-price price-rub">340,000</span>
                                </div>
                                <div class="product-rating">
                                    <div class="stars">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star-half-alt"></i>
                                    </div>
                                    <span class="rating-count">(24)</span>
                                </div>
                            </div>
                            <div class="product-footer">
                                <button class="btn-add-cart" data-product-id="1" data-price="285000" onclick="addToCart(1, this)">
                                    <i class="fas fa-shopping-bag"></i>
                                    <span>В корзину</span>
                                </button>
                                <a href="/product/1" class="btn-view" title="Подробнее">
                                    <i class="fas fa-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Продукт 2 -->
                    <div class="product-card" data-category="exclusive">
                        <div class="product-badges">
                            <span class="product-badge badge-exclusive">Эксклюзив</span>
                            <span class="product-badge badge-vip">VIP</span>
                        </div>
                        <div class="product-image">
                            <img src="{{ url_for('static', filename='img/products/product-2.jpg') }}" alt="Костюм Vogue Elite" onerror="this.src='{{ url_for('static', filename='img/placeholder.jpg') }}';">
                            <div class="product-actions">
                                <button class="action-btn" title="В избранное" onclick="toggleWishlist(2, this)">
                                    <i class="far fa-heart"></i>
                                </button>
                                <button class="action-btn" title="Быстрый просмотр" onclick="quickView(2)">
                                    <i class="far fa-eye"></i>
                                </button>
                                <button class="action-btn" title="Сравнить" onclick="addToCompare(2, this)">
                                    <i class="fas fa-exchange-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">Костюмы</div>
                            <h3 class="product-title">Костюм из кашемира с золотой отделкой</h3>
                            <p class="product-description">Премиальный костюм из итальянского кашемира с золотой ручной вышивкой.</p>
                            <div class="product-meta">
                                <div class="product-price">
                                    <span class="current-price price-rub">420,000</span>
                                </div>
                                <div class="product-rating">
                                    <div class="stars">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="far fa-star"></i>
                                    </div>
                                    <span class="rating-count">(18)</span>
                                </div>
                            </div>
                            <div class="product-footer">
                                <button class="btn-add-cart" data-product-id="2" data-price="420000" onclick="addToCart(2, this)">
                                    <i class="fas fa-shopping-bag"></i>
                                    <span>В корзину</span>
                                </button>
                                <a href="/product/2" class="btn-view" title="Подробнее">
                                    <i class="fas fa-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Продукт 3 -->
                    <div class="product-card" data-category="bestseller">
                        <div class="product-badges">
                            <span class="product-badge badge-sale">-30%</span>
                            <span class="product-badge badge-bestseller">Бестселлер</span>
                        </div>
                        <div class="product-image">
                            <img src="{{ url_for('static', filename='img/products/product-3.jpg') }}" alt="Пальто Vogue Elite" onerror="this.src='{{ url_for('static', filename='img/placeholder.jpg') }}';">
                            <div class="product-actions">
                                <button class="action-btn" title="В избранное" onclick="toggleWishlist(3, this)">
                                    <i class="far fa-heart"></i>
                                </button>
                                <button class="action-btn" title="Быстрый просмотр" onclick="quickView(3)">
                                    <i class="far fa-eye"></i>
                                </button>
                                <button class="action-btn" title="Сравнить" onclick="addToCompare(3, this)">
                                    <i class="fas fa-exchange-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">Пальто</div>
                            <h3 class="product-title">Кашемировое пальто с норковым воротником</h3>
                            <p class="product-description">Теплое пальто из чистого кашемира с натуральным норковым воротником.</p>
                            <div class="product-meta">
                                <div class="product-price">
                                    <span class="current-price price-rub">315,000</span>
                                    <span class="original-price price-rub">450,000</span>
                                </div>
                                <div class="product-rating">
                                    <div class="stars">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                    </div>
                                    <span class="rating-count">(42)</span>
                                </div>
                            </div>
                            <div class="product-footer">
                                <button class="btn-add-cart" data-product-id="3" data-price="315000" onclick="addToCart(3, this)">
                                    <i class="fas fa-shopping-bag"></i>
                                    <span>В корзину</span>
                                </button>
                                <a href="/product/3" class="btn-view" title="Подробнее">
                                    <i class="fas fa-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Продукт 4 -->
                    <div class="product-card" data-category="new">
                        <div class="product-badges">
                            <span class="product-badge badge-new">Новинка</span>
                        </div>
                        <div class="product-image">
                            <img src="{{ url_for('static', filename='img/products/product-4.jpg') }}" alt="Сумка Vogue Elite" onerror="this.src='{{ url_for('static', filename='img/placeholder.jpg') }}';">
                            <div class="product-actions">
                                <button class="action-btn" title="В избранное" onclick="toggleWishlist(4, this)">
                                    <i class="far fa-heart"></i>
                                </button>
                                <button class="action-btn" title="Быстрый просмотр" onclick="quickView(4)">
                                    <i class="far fa-eye"></i>
                                </button>
                                <button class="action-btn" title="Сравнить" onclick="addToCompare(4, this)">
                                    <i class="fas fa-exchange-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="product-info">
                            <div class="product-category">Сумки</div>
                            <h3 class="product-title">Кожаная сумка с бриллиантовой застежкой</h3>
                            <p class="product-description">Лимитированная серия сумок из кожи крокодила с платиновой фурнитурой.</p>
                            <div class="product-meta">
                                <div class="product-price">
                                    <span class="current-price price-rub">850,000</span>
                                </div>
                                <div class="product-rating">
                                    <div class="stars">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star-half-alt"></i>
                                    </div>
                                    <span class="rating-count">(7)</span>
                                </div>
                            </div>
                            <div class="product-footer">
                                <button class="btn-add-cart" data-product-id="4" data-price="850000" onclick="addToCart(4, this)">
                                    <i class="fas fa-shopping-bag"></i>
                                    <span>В корзину</span>
                                </button>
                                <a href="/product/4" class="btn-view" title="Подробнее">
                                    <i class="fas fa-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
            
            <div class="view-all-section">
                <a href="{{ url_for('catalog_page') }}" class="btn-view-all">
                    <span>ВЕСЬ КАТАЛОГ</span>
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- Features -->
    <section class="features-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">ПРЕИМУЩЕСТВА VOGUE ÉLITE</h2>
                <p class="section-subtitle">Мы создаем эксклюзивные условия для наших клиентов</p>
            </div>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-gem"></i>
                    </div>
                    <h3 class="feature-title">Эксклюзивные материалы</h3>
                    <p class="feature-description">Используем только премиальные материалы: натуральный шелк, кашемир, кожу экзотических животных.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-ruler-combined"></i>
                    </div>
                    <h3 class="feature-title">Индивидуальный пошив</h3>
                    <p class="feature-description">Возможность создания одежды по вашим меркам с учетом всех особенностей фигуры.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-truck"></i>
                    </div>
                    <h3 class="feature-title">VIP доставка</h3>
                    <p class="feature-description">Бесплатная доставка по всему миру. Персональный курьер и подарочная упаковка.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <h3 class="feature-title">Персональный стилист</h3>
                    <p class="feature-description">Каждому клиенту предоставляется персональный стилист для создания идеального образа.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Stats -->
    <section class="stats-section">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">{{ total_products }}+</div>
                    <div class="stat-text">Товаров в каталоге</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ total_categories }}+</div>
                    <div class="stat-text">Категорий</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">50+</div>
                    <div class="stat-text">Стран доставки</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">24/7</div>
                    <div class="stat-text">Поддержка клиентов</div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA -->
    <section class="cta-section">
        <div class="cta-bg"></div>
        <div class="container">
            <div class="cta-content">
                <h2 class="cta-title">СТАНЬТЕ ЧАСТЬЮ ЭЛИТЫ</h2>
                <p class="cta-text">Присоединяйтесь к клубу Vogue Élite и получите эксклюзивный доступ к закрытым коллекциям, персональные скидки и привилегии высшего уровня.</p>
                <div class="hero-btns">
                    <a href="{{ url_for('register') }}" class="btn-primary">
                        <i class="fas fa-crown"></i>
                        <span>СТАТЬ VIP КЛИЕНТОМ</span>
                    </a>
                    <a href="tel:{{ shop_phone }}" class="btn-secondary">
                        <i class="fas fa-phone"></i>
                        <span>ЗАКАЗАТЬ КОНСУЛЬТАЦИЮ</span>
                    </a>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block extra_js %}
<script>
// Глобальная функция уведомлений (исправленная)
window.showNotification = function(message, type = 'info', duration = 3000) {
    const notification = document.createElement('div');
    notification.className = `cart-notification cart-notification-${type}`;
    notification.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check-circle' : 
                       type === 'error' ? 'exclamation-circle' : 
                       type === 'warning' ? 'exclamation-triangle' : 
                       'info-circle'}"></i>
        <span>${message}</span>
        <button class="notification-close" style="background: none; border: none; color: white; cursor: pointer;">
            <i class="fas fa-times"></i>
        </button>
    `;
    
    document.body.appendChild(notification);
    
    // Show notification
    setTimeout(() => {
        notification.classList.add('show');
    }, 10);
    
    // Close button
    notification.querySelector('.notification-close').addEventListener('click', () => {
        notification.classList.remove('show');
        setTimeout(() => {
            if (notification.parentNode) {
                notification.remove();
            }
        }, 300);
    });
    
    // Auto hide after duration
    setTimeout(() => {
        if (notification.parentNode) {
            notification.classList.remove('show');
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 300);
        }
    }, duration);
};

// Функция добавления в корзину (исправленная)
async function addToCart(productId, button) {
    try {
        // Проверяем авторизацию
        const authCheck = await fetch('/api/auth/check');
        const authData = await authCheck.json();
        
        if (!authData.is_authenticated) {
            showNotification('Для добавления в корзину необходимо войти в систему', 'warning');
            window.location.href = '/login?next=' + encodeURIComponent(window.location.pathname);
            return;
        }

        const response = await fetch('/api/cart/add', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                product_id: productId,
                quantity: 1
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            // Обновляем кнопку
            if (button) {
                const icon = button.querySelector('i');
                const textSpan = button.querySelector('span');
                
                // Проверяем существование элементов
                if (icon) {
                    icon.className = 'fas fa-check';
                }
                if (textSpan) {
                    textSpan.textContent = 'Добавлено';
                }
                button.style.background = '#10b981';
                button.style.color = 'white';
                button.disabled = true;
                
                // Возвращаем через 2 секунды
                setTimeout(() => {
                    if (icon) {
                        icon.className = 'fas fa-shopping-bag';
                    }
                    if (textSpan) {
                        textSpan.textContent = 'В корзину';
                    }
                    button.style.background = '';
                    button.style.color = '';
                    button.disabled = false;
                }, 2000);
            }
            
            showNotification(data.message || 'Товар добавлен в корзину', 'success');
            updateCartCount();
        } else {
            showNotification(data.message || 'Ошибка добавления в корзину', 'error');
        }
    } catch (error) {
        console.error('Error adding to cart:', error);
        showNotification('Ошибка добавления в корзину', 'error');
    }
}

// Функция обновления счетчика корзины
function updateCartCount() {
    fetch('/api/cart')
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const cartCountElements = document.querySelectorAll('.cart-count, #cart-count, .mobile-cart-count');
                cartCountElements.forEach(element => {
                    if (element) {
                        element.textContent = data.count;
                        element.style.display = data.count > 0 ? 'flex' : 'none';
                    }
                });
                
                // Обновляем иконку корзины в шапке
                const cartIcon = document.querySelector('.cart-link, .header-cart');
                if (cartIcon) {
                    cartIcon.setAttribute('data-count', data.count);
                    if (data.count > 0) {
                        cartIcon.classList.add('has-items');
                    } else {
                        cartIcon.classList.remove('has-items');
                    }
                }
            }
        })
        .catch(error => {
            console.error('Error updating cart count:', error);
        });
}

// Функция избранного (исправленная)
async function toggleWishlist(productId, button) {
    try {
        if (!button) return;
        
        const icon = button.querySelector('i');
        if (!icon) return;
        
        // Проверяем авторизацию
        const authCheck = await fetch('/api/auth/check');
        const authData = await authCheck.json();
        
        if (!authData.is_authenticated) {
            showNotification('Для добавления в избранное необходимо войти в систему', 'warning');
            window.location.href = '/login?next=' + encodeURIComponent(window.location.pathname);
            return;
        }
        
        const isFar = icon.classList.contains('far');
        const action = isFar ? 'add' : 'remove';
        
        const response = await fetch('/api/wishlist', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                action: action,
                product_id: productId
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            if (isFar) {
                icon.className = 'fas fa-heart';
                icon.style.color = '#ef4444';
                showNotification('Товар добавлен в избранное', 'info');
            } else {
                icon.className = 'far fa-heart';
                icon.style.color = '';
                showNotification('Товар удален из избранного', 'info');
            }
        } else {
            showNotification(data.message || 'Ошибка', 'error');
        }
    } catch (error) {
        console.error('Error toggling wishlist:', error);
        showNotification('Ошибка сервера', 'error');
    }
}

// Функция добавления в сравнение
async function addToCompare(productId, button) {
    try {
        if (!button) return;
        
        // Проверяем авторизацию
        const authCheck = await fetch('/api/auth/check');
        const authData = await authCheck.json();
        
        if (!authData.is_authenticated) {
            showNotification('Для добавления в сравнение необходимо войти в систему', 'warning');
            window.location.href = '/login?next=' + encodeURIComponent(window.location.pathname);
            return;
        }
        
        const response = await fetch('/api/compare', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                action: 'add',
                product_id: productId
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            showNotification('Товар добавлен в сравнение', 'success');
            if (button.querySelector('i')) {
                button.querySelector('i').style.color = '#10b981';
            }
        } else {
            showNotification(data.message || 'Ошибка', 'error');
        }
    } catch (error) {
        console.error('Error adding to compare:', error);
        showNotification('Ошибка сервера', 'error');
    }
}

// Быстрый просмотр
async function quickView(productId) {
    try {
        const response = await fetch(`/api/products/${productId}`);
        const data = await response.json();
        
        if (data.success && data.product) {
            const product = data.product;
            
            // Создаем модальное окно
            const modal = document.createElement('div');
            modal.className = 'quick-view-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 9999;
                opacity: 0;
                transition: opacity 0.3s;
            `;
            
            modal.innerHTML = `
                <div class="quick-view-content" style="
                    background: var(--card-bg);
                    border-radius: var(--radius-xl);
                    width: 90%;
                    max-width: 900px;
                    max-height: 90vh;
                    overflow-y: auto;
                    position: relative;
                    transform: translateY(20px);
                    transition: transform 0.3s;
                ">
                    <button class="quick-view-close" style="
                        position: absolute;
                        top: 20px;
                        right: 20px;
                        background: transparent;
                        border: none;
                        color: var(--text-primary);
                        font-size: 24px;
                        cursor: pointer;
                        z-index: 10;
                    ">
                        <i class="fas fa-times"></i>
                    </button>
                    
                    <div class="quick-view-body" style="
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 40px;
                        padding: 40px;
                    ">
                        <div class="quick-view-image">
                            <img src="${product.image_url || '/static/img/placeholder.jpg'}" alt="${product.name}" style="
                                width: 100%;
                                height: 400px;
                                object-fit: cover;
                                border-radius: var(--radius-lg);
                            " onerror="this.src='/static/img/placeholder.jpg';">
                        </div>
                        
                        <div class="quick-view-info">
                            <h3 style="font-size: 1.8rem; margin-bottom: 15px; color: var(--text-primary);">${product.name}</h3>
                            <div style="font-size: 1.5rem; color: var(--gold); margin-bottom: 20px; font-weight: bold;">
                                ${product.price.toLocaleString()} ₽
                                ${product.old_price ? `<span style="font-size: 1rem; color: var(--text-tertiary); text-decoration: line-through; margin-left: 10px;">${product.old_price.toLocaleString()} ₽</span>` : ''}
                            </div>
                            <p style="color: var(--text-secondary); margin-bottom: 25px; line-height: 1.6;">${product.description}</p>
                            
                            <div class="quick-view-actions" style="display: flex; gap: 15px;">
                                <button onclick="addToCart(${product.id}, this)" style="
                                    flex: 1;
                                    padding: 15px;
                                    background: var(--gold);
                                    color: white;
                                    border: none;
                                    border-radius: var(--radius-lg);
                                    font-weight: 600;
                                    cursor: pointer;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    gap: 10px;
                                ">
                                    <i class="fas fa-shopping-bag"></i>
                                    <span>В корзину</span>
                                </button>
                                
                                <button onclick="toggleWishlist(${product.id}, this)" style="
                                    width: 50px;
                                    background: var(--surface-bg);
                                    border: none;
                                    border-radius: var(--radius-lg);
                                    color: var(--text-primary);
                                    cursor: pointer;
                                ">
                                    <i class="far fa-heart"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            setTimeout(() => {
                modal.style.opacity = '1';
                modal.querySelector('.quick-view-content').style.transform = 'translateY(0)';
            }, 10);
            
            // Закрытие модального окна
            const closeModal = () => {
                modal.style.opacity = '0';
                modal.querySelector('.quick-view-content').style.transform = 'translateY(20px)';
                setTimeout(() => modal.remove(), 300);
            };
            
            modal.querySelector('.quick-view-close').addEventListener('click', closeModal);
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });
            
            // Закрытие по ESC
            document.addEventListener('keydown', function escHandler(e) {
                if (e.key === 'Escape') {
                    closeModal();
                    document.removeEventListener('keydown', escHandler);
                }
            });
        } else {
            showNotification('Товар не найден', 'error');
        }
    } catch (error) {
        console.error('Error loading quick view:', error);
        showNotification('Ошибка загрузки товара', 'error');
    }
}

// Инициализация при загрузке страницы
document.addEventListener('DOMContentLoaded', function() {
    console.log('Инициализация главной страницы...');
    
    // Product Filtering
    const filterButtons = document.querySelectorAll('.filter-btn');
    const productCards = document.querySelectorAll('.product-card');
    
    if (filterButtons.length > 0 && productCards.length > 0) {
        filterButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Remove active class from all buttons
                filterButtons.forEach(btn => btn.classList.remove('active'));
                // Add active class to clicked button
                this.classList.add('active');
                
                const filterValue = this.getAttribute('data-filter');
                
                // Filter products
                productCards.forEach(card => {
                    card.style.transition = 'all 0.3s ease';
                    if (filterValue === 'all') {
                        card.style.display = 'block';
                        setTimeout(() => {
                            card.style.opacity = '1';
                            card.style.transform = 'translateY(0)';
                        }, 10);
                    } else {
                        const categories = card.getAttribute('data-category');
                        if (categories && categories.includes(filterValue)) {
                            card.style.display = 'block';
                            setTimeout(() => {
                                card.style.opacity = '1';
                                card.style.transform = 'translateY(0)';
                            }, 10);
                        } else {
                            card.style.opacity = '0';
                            card.style.transform = 'translateY(20px)';
                            setTimeout(() => {
                                card.style.display = 'none';
                            }, 300);
                        }
                    }
                });
            });
        });
    }
    
    // Add hover effects to collection cards
    const collectionCards = document.querySelectorAll('.collection-card');
    collectionCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-15px) scale(1.02)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });
    
    // Add hover effects to feature cards
    const featureCards = document.querySelectorAll('.feature-card');
    featureCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-10px) scale(1.03)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });
    
    // Добавляем обработчики для кнопок добавления в корзину
    document.querySelectorAll('.btn-add-cart').forEach(button => {
        button.addEventListener('click', function(e) {
            e.stopPropagation();
        });
    });
    
    // Инициализируем Swiper если он есть на странице
    if (document.querySelector('.swiper-container')) {
        // Добавляем скрипт Swiper если его нет
        if (typeof Swiper === 'undefined') {
            const swiperScript = document.createElement('script');
            swiperScript.src = 'https://unpkg.com/swiper/swiper-bundle.min.js';
            swiperScript.onload = function() {
                initializeSwiper();
            };
            document.head.appendChild(swiperScript);
            
            // Добавляем CSS Swiper
            const swiperCSS = document.createElement('link');
            swiperCSS.rel = 'stylesheet';
            swiperCSS.href = 'https://unpkg.com/swiper/swiper-bundle.min.css';
            document.head.appendChild(swiperCSS);
        } else {
            initializeSwiper();
        }
    }
    
    function initializeSwiper() {
        try {
            const swiper = new Swiper('.swiper-container', {
                direction: 'horizontal',
                loop: true,
                autoplay: {
                    delay: 5000,
                    disableOnInteraction: false,
                },
                pagination: {
                    el: '.swiper-pagination',
                    clickable: true,
                },
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
                effect: 'fade',
                fadeEffect: {
                    crossFade: true
                },
            });
            console.log('Swiper инициализирован');
        } catch (error) {
            console.error('Ошибка инициализации Swiper:', error);
        }
    }
    
    // Update cart count on page load
    updateCartCount();
    
    // Проверяем авторизацию
    checkAuth();
    
    console.log('Главная страница инициализирована');
});

// Функция проверки авторизации
async function checkAuth() {
    try {
        const response = await fetch('/api/auth/check');
        const data = await response.json();
        
        if (data.is_authenticated) {
            // Обновляем информацию о пользователе в шапке
            const userMenu = document.querySelector('.user-menu');
            if (userMenu) {
                const authLinks = userMenu.querySelector('.auth-links');
                if (authLinks) {
                    authLinks.style.display = 'none';
                }
                
                // Показываем меню пользователя
                const userProfile = userMenu.querySelector('.user-profile');
                if (userProfile) {
                    userProfile.style.display = 'flex';
                    
                    const userName = userProfile.querySelector('.user-name');
                    if (userName && data.user) {
                        userName.textContent = data.user.first_name || 'Пользователь';
                    }
                    
                    // Обновляем статус VIP
                    if (data.user.is_vip) {
                        userProfile.classList.add('vip-user');
                    }
                }
            }
        }
    } catch (error) {
        console.error('Ошибка проверки авторизации:', error);
    }
}

// Функция для форматирования цены
function formatPrice(price) {
    if (!price) return '0';
    return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
}

// Добавляем обработчик ошибок изображений
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('img').forEach(img => {
        img.onerror = function() {
            this.src = '{{ url_for("static", filename="img/placeholder.jpg") }}';
        };
    });
});
</script>
{% endblock %}
